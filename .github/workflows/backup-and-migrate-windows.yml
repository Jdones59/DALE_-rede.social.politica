name: Backup and Apply Migrations (Windows)

on:
  workflow_dispatch: {}

jobs:
  backup-and-migrate-windows:
    runs-on: windows-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Start Postgres via docker-compose
        run: docker-compose up -d postgres

      - name: Run backup and migrations (PowerShell)
        shell: pwsh
        run: ./backend/scripts/backup_and_migrate_ci.ps1 -RunMigrations
